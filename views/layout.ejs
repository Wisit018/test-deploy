<!DOCTYPE html>
<html lang="th" data-bs-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title><%= title || 'Siamdrug App' %></title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <!-- Google Font: Sarabun (Thai) -->
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700&display=swap" rel="stylesheet">
    <!-- App styles placed after Bootstrap to override if needed -->
    <link rel="stylesheet" href="/styles.css" />
    <script>
      // Early theme apply to avoid flash
      (function() {
        try {
          var saved = localStorage.getItem('theme');
          if (saved === 'dark' || saved === 'light') {
            document.documentElement.setAttribute('data-bs-theme', saved);
          }
        } catch (e) {}
      })();
    </script>
  </head>
  <body>
    <%- include('partials/header') %>
    <main class="container my-4">
      <%- body %>
    </main>
    <%- include('partials/footer') %>
    <!-- Bootstrap 5 JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script>
      // Theme toggle button handler + icon sync
      function setTheme(next) {
        document.documentElement.setAttribute('data-bs-theme', next);
        try { localStorage.setItem('theme', next); } catch (err) {}
        var icon = document.querySelector('[data-theme-icon]');
        if (icon) {
          icon.classList.remove('bi-sun','bi-moon-stars');
          icon.classList.add(next === 'dark' ? 'bi-sun' : 'bi-moon-stars');
        }
      }
      (function initTheme() {
        var current = document.documentElement.getAttribute('data-bs-theme') || 'light';
        setTheme(current); // ensure icon correct
      })();
      document.addEventListener('click', function(e){
        var btn = e.target.closest('[data-toggle-theme]');
        if (!btn) return;
        var current = document.documentElement.getAttribute('data-bs-theme') || 'light';
        var next = current === 'dark' ? 'light' : 'dark';
        setTheme(next);
      });
    </script>
  </body>
  </html>
